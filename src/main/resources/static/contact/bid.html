<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>投标管理</title>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="0">

    <script type="text/javascript">
        var config = {
            "webRoot": "\/",
            "appName": "",
            "cookieLife": 30,
            "requestType": "PATH_INFO",
            "requestFix": "-",
            "moduleVar": "m",
            "methodVar": "f",
            "viewVar": "t",
            "defaultView": "html",
            "themeRoot": "\/theme\/",
            "currentModule": "product",
            "currentMethod": "browse",
            "clientLang": "zh-cn",
            "requiredFields": "",
            "router": "\/index.php",
            "save": "\u4fdd\u5b58",
            "runMode": "",
            "timeout": 30000,
            "pingInterval": ""
        };
        var lang = {
            "submitting": "\u7a0d\u5019...",
            "save": "\u4fdd\u5b58",
            "timeout": "\u8fde\u63a5\u8d85\u65f6\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u73af\u5883\uff0c\u6216\u91cd\u8bd5\uff01"
        };
    </script>

    <script src="../lib/zui/all.js" type="text/javascript"></script>
    <script src="../lib/grid/util.js" type="text/javascript"></script>
    <script src="../lib/grid/grid.js" type="text/javascript"></script>
    <script src="../lib/grid/zgrid.js" type="text/javascript"></script>
	<script src="../lib/zui/uploader/zui.uploader-ext.js"></script>


	<link href="../lib/zui/uploader/zui.uploader.min.css" rel="stylesheet">
    <link href="../lib/zui/css/zh-cn.default.css" type="text/css" rel="stylesheet" media="screen">
    <link href="../lib/zui/css/zui.min.css" type="text/css" rel="stylesheet" media="screen">
    <link href="../lib/grid/css/grid.css" type="text/css" rel="stylesheet" media="screen">

    <style>
        #createActionMenu .dropdown-menu {
            width: 100%
        }

        .dropdown-menu.with-search {
            padding: 0;
            min-width: 150px;
            overflow: hidden;
            max-height: 302px;
        }

        .dropdown-menu > .menu-search .input-group {
            width: 100%;
        }

        .dropdown-menu > .menu-search .input-group-addon {
            position: absolute;
            right: 10px;
            top: 0;
            z-index: 10;
            background: none;
            border: none;
            color: #666
        }

        .dropdown-menu > .menu-search .form-control {
            border: none !important;
            box-shadow: none !important;
            border-top: 1px solid #ddd !important;
        }

        .dropdown-list {
            display: block;
            padding: 0;
            max-height: 270px;
            overflow-y: auto;
        }

        .dropdown-list > li > a {
            display: block;
            padding: 3px 20px;
            clear: both;
            font-weight: normal;
            line-height: 1.53846154;
            color: #141414;
            white-space: nowrap;
        }

        .dropdown-list > li > a:hover,
        .dropdown-list > li > a:focus {
            color: #1a4f85;
            text-decoration: none;
            background-color: #ddd;
        }

        .pl-5px {
            padding-left: 5px;
        }

        a.removeModule {
            color: #ddd
        }

        a.removeModule:hover {
            color: red
        }

        tbody > tr > td > .btn-icon {
            margin-right: 3px;
        }
		.table{width:98.5%}
		
		#addButton {
			 width: 100px;
			 height: 35px;
			 position: absolute;
			 right: 5%;
			 top: 40%;
		}
		#querybox {
			width: 1200px;
			top: 30px;
			right: 315px;
		}
		#featurebar{
			height: 220px;
		}

        .editpanel {display: none;}
    </style>
</head>
<body>
<div id="wrap" style="width: 2500px; margin: 0 auto" class="mainpanel">
    <div class="outer with-side with-transition" style="min-height: 900px;">
        <div id="featurebar">
		       <ul class="nav">
                    <li><div class="label-angle">所有模块</div></li>
                    <li class="active"><a href="">用户管理</a></li>
                    <li><a href="">员工培训</a></li>
                    <li><a href="">未签责任书员工</a></li>
                </ul>
            <div id="querybox" class="show" style="width:1200px">
                <form id="searchform" class="form-condensed">
                    <table class="table table-condensed table-form" id="bug-search"
                           style="max-width: 100%; margin: 0 auto">
                        <tbody>
                        <tr>
                            <td class="w-400px">
                                <table class="table active-disabled table-fixed">
                                    <tbody>
                                    <tr id="searchbox1" class="" style="max-width: 100%; margin: 0 auto">
                                        <td class="text-right w-90px"><span><strong>工程名称</strong></span></td>
                                        <td id="" style="overflow: visible">
                                            <input type="text" class="form-control  searchInput" name="unitName"
                                                   placeholder="请输入工程名称（可模糊查询）">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="text-right w-90px"><span><strong>报名时间</strong></span></td>
                                        <td>
                                            <input type="text" class="form-control form-date" name="licenceBegindate"
                                                   placeholder="yyyy-mm-dd" readonly
                                                   style="width: 49%; background-color: white; float: left;">
                                            <span style="float: left; margin-top: 5px;">&nbsp;-&nbsp;&nbsp;</span>
                                            <input type="text" class="form-control form-date" name="licenceEnddate"
                                                   placeholder="yyyy-mm-dd" readonly
                                                   style="width: 49%; background-color: white; float: left;">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="text-right w-90px"><span><strong>保证金截止时间</strong></span></td>
                                        <td>
                                            <input type="text" class="form-control form-date" name="licenceBegindate"
                                                   placeholder="yyyy-mm-dd" readonly
                                                   style="width: 49%; background-color: white; float: left;">
                                            <span style="float: left; margin-top: 5px;">&nbsp;-&nbsp;&nbsp;</span>
                                            <input type="text" class="form-control form-date" name="licenceEnddate"
                                                   placeholder="yyyy-mm-dd" readonly
                                                   style="width: 49%; background-color: white; float: left;">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="text-right w-90px"><span><strong>开标时间</strong></span></td>
                                        <td>
                                            <input type="text" class="form-control form-date" name="licenceBegindate"
                                                   placeholder="yyyy-mm-dd" readonly
                                                   style="width: 49%; background-color: white; float: left;">
                                            <span style="float: left; margin-top: 5px;">&nbsp;-&nbsp;&nbsp;</span>
                                            <input type="text" class="form-control form-date" name="licenceEnddate"
                                                   placeholder="yyyy-mm-dd" readonly
                                                   style="width: 49%; background-color: white; float: left;">
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                            <td class="w-160px">
                                <div class="btn-group">
                                    <a type="submit" id="searchbtn" class="btn btn-primary" data-loading="稍候...">搜索</a>
                                    <button type="reset" class="btn btn-default">重置</button>
                                </div>
								<button type="reset" id="addButton" class="btn btn-success" style="width:100px;height:35px"><i class="icon icon-plus"></i>新增记录</button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </form>
            </div>
        </div>
        <div>
            <table class="table table-condensed table-hover table-striped tablesorter table-fixed" style="top: 230px;position: absolute;">
                <thead>
                <tr>
                    <th width="3%">编号</th>
                    <th width="4%">区域</th>
                    <th width="5%">内部负责人</th>
                    <th width="5%">信息发布时间</th>
                    <th width="5%">工程名称</th>
                    <th width="5%">工程类型</th>
                    <th width="5%">招标价格</th>
                    <th width="5%">报名时间</th>
                    <th width="5%">建造师</th>
                    <th width="5%">投标保证金数额</th>
                    <th width="5%">保证金截止日期</th>
                    <th width="5%">交保证金审批</th>
                    <th width="5%">保证金汇出时间</th>
                    <th width="5%">开标时间</th>
                    <th width="5%">开标结果</th>
                    <th width="5%">保证金退回时间</th>
                    <th width="5%">银行凭证</th>
                    <th width="10%">备注</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody class="grid">
                <tr class="text-center">
                    <td>{rowIndex}</td>
                    <td>{area}</td>
                    <td>{principal}</td>
                    <td>{pubDate}</td>
                    <td>{name}</td>
                    <td>{type}</td>
                    <td>{bidPrice}</td>
                    <td>{applyDate}</td>
                    <td>{constructor}</td>
                    <td>{depositPrice}</td>
					<td>{depositDeadline}</td>
					<td>{depositApprovalResult}</td>
					<td>{depositRemitTime}</td>
					<td>{bidOpenTime}</td>
					<td>{bidOpenResultMessage}</td>
					<td>{depositReturnTime}</td>
					<td><button class="btn btn-info " type="button">上传</button>&nbsp;<button type="reset"  class="btn btn-primary " ><i class="icon icon-double-angle-down"></i></button></td>
					<td>{remark}</td>
					<td><button class="btn btn-primary" type="button" name="editButton" onclick="bidEdit({id})">编辑</button>&nbsp;<button class="btn btn-success" type="button" name="submitButton" onclick="bidSubmit({id})">入库</button>&nbsp;<button class="btn btn-danger" type="button" name="deleteButton" onclick="bidDel({id})">删除</button></td>
                </tr>
                </tbody>
                <tfoot>
                <tr>
                    <td colspan="11">
                        <div class="table-actions clearfix">
                        </div>
                        <div class="text-right">
                            <div style="float: right; clear: none;" class="pager form-inline" id="pagination">
                            </div>
                        </div>
                    </td>
                </tr>
                </tfoot>
            </table>
        </div>
    </div>
</div>

    <div id="wrap" class="editpanel">
        <div class="outer" style="min-height: 501px;">
            <div id="featurebar" style="height:75px">
                <div class="heading" style="padding-right: 179px;" id="title">
                    <i class="icon-edit"></i> 编辑：
                </div>
                <div class="actions">
                    <a id="back" href="javascript:" class="btn btn-back"><i class="icon-chevron-left"></i> 返回</a>
                    <a id="save" href="javascript:" class="btn btn-save"><i class="icon-save"></i> 保存</a>
                </div>
            </div>
            <div class="container mw-1400px">
                <div id="titlebar">
                    <div class="heading">
                        <span class="prefix"><i class="icon-file-text"></i></span> <strong><small class="text-muted"><i class="icon icon-plus"></i></small> 招标信息：</strong>
                    </div>
                </div>
                <form id="editform" class="form-horizontal">
                    <input type="text" class="form-control" id="id" name="id" style="display: none;">

                    <div class="form-group">
                        <label for="area" class="col-sm-2">区域</label>
                        <div class="col-md-8 col-sm-10">
                            <input type="text" class="form-control" id="area" name="area" placeholder="区域">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="principal" class="col-sm-2">内部负责人</label>
                        <div class="col-md-8 col-sm-10">
                            <input type="text" class="form-control" id="principal" name="principal" placeholder="内部负责人">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="pubDate" class="col-sm-2">信息发布时间</label>
                        <div class="col-md-8 col-sm-10">
                            <input type="text" class="form-control form-date" id="pubDate" name="pubDate" placeholder="信息发布时间" readonly style="width: 100%; background-color: white; float: left;">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="name" class="col-sm-2">工程名称</label>
                        <div class="col-md-8 col-sm-10">
                            <input type="text" class="form-control" id="name" name="name" placeholder="工程名称">
                        </div>
                    </div>
					<div class="form-group">
                        <label for="type" class="col-sm-2">工程类型</label>
                        <div class="col-md-8 col-sm-10">
                            <input type="text" class="form-control" id="type" name="type" placeholder="工程类型">
                        </div>
                    </div>
					<div class="form-group">
                        <label for="bidPrice" class="col-sm-2">招标价格</label>
                        <div class="col-md-8 col-sm-10">
                            <input type="text" class="form-control" id="bidPrice" name="bidPrice" placeholder="招标价格">
                        </div>
                    </div>
					<div class="form-group">
                        <label for="applyDate" class="col-sm-2">报名时间</label>
                        <div class="col-md-8 col-sm-10">
                            <input type="text" class="form-control form-date" id="applyDate" name="applyDate" placeholder="报名时间" readonly style="width: 100%; background-color: white; float: left;">
                        </div>
                    </div>
					<div class="form-group">
                        <label for="constructor" class="col-sm-2">建造师</label>
                        <div class="col-md-8 col-sm-10">
                            <input type="text" class="form-control" id="constructor" name="constructor" placeholder="建造师">
                     </div>
                    </div>
					<div class="form-group">
                        <label for="depositPrice" class="col-sm-2">投标保证金数额</label>
                        <div class="col-md-8 col-sm-10">
                            <input type="text" class="form-control" id="depositPrice" name="depositPrice" placeholder="投标保证金数额">
                        </div>
                    </div>
					<div class="form-group">
                        <label for="depositDeadline" class="col-sm-2">保证金截止日期</label>
                        <div class="col-md-8 col-sm-10">
                            <input type="text" class="form-control form-date" id="depositDeadline" name="depositDeadline" placeholder="保证金截止日期" readonly style="width: 100%; background-color: white; float: left;">
                        </div>
                    </div>
					<div class="form-group">
                        <label for="depositRemitTime" class="col-sm-2">保证金汇出时间</label>
                        <div class="col-md-8 col-sm-10">
                            <input type="text" class="form-control form-date" id="depositRemitTime" name="depositRemitTime" placeholder="保证金汇出时间" readonly style="width: 100%; background-color: white; float: left;">
                        </div>
                    </div>
					<div class="form-group">
                        <label for="bidOpenTime" class="col-sm-2">开标时间</label>
                        <div class="col-md-8 col-sm-10">
                            <input type="text" class="form-control form-date" id="bidOpenTime" name="bidOpenTime" placeholder="开标时间" readonly style="width: 100%; background-color: white; float: left;">
                        </div>
                    </div>
					<div class="form-group" id="depositReturnTimeDiv">
                        <label for="depositReturnTime" class="col-sm-2">保证金退回时间</label>
                        <div class="col-md-8 col-sm-10">
                            <input type="text" class="form-control form-date" id="depositReturnTime" name="depositReturnTime" placeholder="保证金退回时间" readonly style="width: 100%; background-color: white; float: left;">
                        </div>
                    </div>
					<div class="form-group">
                        <label for="remark" class="col-sm-2">备注</label>
                        <div class="col-md-8 col-sm-10">
                            <input type="text" class="form-control" id="remark" name="remark" placeholder="备注">
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>


</body>
<script>
var mainpanel = $('.mainpanel');
var editpanel = $('.editpanel');

    // 仅选择日期
    $(".form-date").datetimepicker(
        {
            language: "zh-cn",
            weekStart: 1,
            todayBtn: 1,
            autoclose: 1,
            todayHighlight: 1,
            startView: 2,
            minView: 2,
            forceParse: 0,
            format: "yyyy-mm-dd"
        });


var grid = $('.grid').grid({
    method: 'GET',
    url: '/bid/findBids',
    autoload: true,
    paginationRender: 'pagination',
    setData: function (data) {
        if(data.depositApproval == 0){
            data.depositApprovalResult = "未审批";
        }
        if(data.depositApproval == 1){
            data.depositApprovalResult = "同意";
        }
        if(data.depositApproval == 2){
            data.depositApprovalResult = "不同意";
        }

        if(data.bidOpenResult == 0){
            data.bidOpenResultMessage = "未开标";
        }
        if(data.bidOpenResult == 1){
            data.bidOpenResultMessage = "中标";
        }
        if(data.bidOpenResult == 2){
            data.bidOpenResultMessage = "未中标";
        }

    }
}).data('grid');

grid.on('rowdoubleclick', function(event) {
	var row = grid.getSelected();
	mainpanel.toggle();
	editpanel.toggle();	
	fillBlanks(row);
});


//为编辑页面赋值
fillBlanks = function(row){
	$("#area").val(row.area);
	$("#principal").val(row.principal);
	$("#pubDate").val(row.pubDate);
	$("#name").val(row.name);
	$("#type").val(row.type);
	$("#bidPrice").val(row.bidPrice);
	$("#applyDate").val(row.applyDate);
	$("#constructor").val(row.constructor);
	$("#depositPrice").val(row.depositPrice);
	$("#depositDeadline").val(row.depositDeadline);
	$("#depositRemitTime").val(row.depositRemitTime);
	$("#bidOpenTime").val(row.bidOpenTime);
	$("#depositReturnTime").val(row.depositReturnTime);
	$("#remark").val(row.remark);
}

//编辑
bidEdit = function(id){
	mainpanel.toggle();
	editpanel.toggle();
}

//提交入库
bidSubmit = function(id){
	if(confirm("确定提交该招标记录入库?")){
	}
}

//删除
bidDel = function(id){
	if(confirm("确定删除该招标记录?")){
            $.ajax({
                type: 'POST',
                url: '/bid/remove',
                data: {id:id},
                success : function(msg) {
                    grid.load();
                    alert("删除成功！");
                },
                error : function(msg) {
					alert("删除失败!");
                }
            });
	}
}

//新增
$("#addButton").click(function(){
	mainpanel.toggle();
	editpanel.toggle();
	$("#depositReturnTimeDiv").hide();
})

$("#back").click(function(){
	mainpanel.toggle();
	editpanel.toggle();
})



</script>
</html>